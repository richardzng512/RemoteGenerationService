{% extends "base.html" %}
{% block title %}Generate Image ‚Äî RemoteGenerationService{% endblock %}

{% block content %}
<h1>üñºÔ∏è Generate Image</h1>

{% if mode == 'real' and not workflows %}
<div class="flash flash-warning">
  ‚ö†Ô∏è No ComfyUI workflows found. <a href="/settings/models">Upload a workflow</a> first.
</div>
{% endif %}

<form method="POST" action="/generate/image/submit">
  <label>
    Prompt
    <textarea name="prompt" rows="4" placeholder="A photorealistic portrait of a cat..." required></textarea>
  </label>
  <label>
    Negative Prompt
    <textarea name="negative_prompt" rows="2" placeholder="blurry, ugly, watermark..."></textarea>
  </label>

  {% if mode == 'real' %}
  <label>
    Workflow
    <select name="workflow" required>
      {% for wf in workflows %}
      <option value="{{ wf }}">{{ wf }}</option>
      {% endfor %}
    </select>
  </label>
  {% else %}
  <input type="hidden" name="workflow" value="">
  {% endif %}

  <div class="grid">
    <label>
      Width
      <select name="width">
        {% for w in [512, 768, 1024, 1280] %}
        <option value="{{ w }}" {% if w == 512 %}selected{% endif %}>{{ w }}</option>
        {% endfor %}
      </select>
    </label>
    <label>
      Height
      <select name="height">
        {% for h in [512, 768, 1024, 1280] %}
        <option value="{{ h }}" {% if h == 512 %}selected{% endif %}>{{ h }}</option>
        {% endfor %}
      </select>
    </label>
    <label>
      Steps
      <input type="number" name="steps" value="20" min="1" max="150">
    </label>
    <label>
      CFG Scale
      <input type="number" name="cfg_scale" value="7.0" min="1" max="30" step="0.5">
    </label>
    <label>
      Seed (-1 = random)
      <input type="number" name="seed" value="-1">
    </label>
    <label>
      Batch Size
      <input type="number" name="batch_size" value="1" min="1" max="8">
    </label>
  </div>

  <button type="submit">
    {% if mode == 'real' %}üöÄ Generate (Real){% else %}üé≠ Generate (Mock){% endif %}
  </button>
</form>
{% endblock %}
